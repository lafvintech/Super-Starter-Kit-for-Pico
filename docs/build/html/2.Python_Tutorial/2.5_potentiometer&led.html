<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter 9 Potentiometer &amp; LED &mdash; Super-Starter-Kit-for-ESP32-S3-WROOM  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about_this_kit.html">About This Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_list.html">Component List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preparation/preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1.C_Tutorial/c_tutorial.html">C Language Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_tutorial.html">Python Language Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components_Kit/Components_Kit.html">Components Introduction</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Super-Starter-Kit-for-ESP32-S3-WROOM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Chapter 9 Potentiometer &amp; LED</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/2.Python_Tutorial/2.5_potentiometer&amp;led.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chapter-9-potentiometer-led">
<h1>Chapter 9 Potentiometer &amp; LED<a class="headerlink" href="#chapter-9-potentiometer-led" title="Link to this heading"></a></h1>
<p>We have already learned about the use of ADC and PWM. In this chapter, we will
learn how to use a potentiometer to control the brightness of LED.</p>
<section id="project-9-1-soft-light">
<h2>Project 9.1 Soft Light<a class="headerlink" href="#project-9-1-soft-light" title="Link to this heading"></a></h2>
<p>In this project, we will make a soft light. We will use an ADC Module to read ADC
values of a potentiometer and map it to duty cycle of the PWM used to control the
brightness of a LED. Then you can change the brightness of a LED by adjusting the
potentiometer.</p>
<section id="component-list">
<h3>Component List<a class="headerlink" href="#component-list" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raspberry Pi Pico W x1</p></li>
<li><p>830 Tie-Points Breadboard x1</p></li>
<li><p>Resistor 220Ω x1</p></li>
<li><p>Potentiometer(10k) x1</p></li>
<li><p>LED x1</p></li>
<li><p>Jumper Wire Several</p></li>
</ul>
</section>
<section id="connect">
<h3>Connect<a class="headerlink" href="#connect" title="Link to this heading"></a></h3>
<img alt="2.Python_Tutorial/img/3.connect/9.1.png" src="2.Python_Tutorial/img/3.connect/9.1.png" />
</section>
<section id="code">
<h3>Code<a class="headerlink" href="#code" title="Link to this heading"></a></h3>
<p>Move the program folder “Super_Starter_Kit_for_ESP32_S3/Python/Python_C
odes” to disk(D) in advance with the path of “D:/Micropython_Codes”.</p>
<p>Open “Thonny”, click “This computer” &gt;&gt; “D:” &gt;&gt; “Micropython_Codes” &gt;&gt; “09.1_Soft_L
ED” and double click “Soft_LED.py”.</p>
<p><strong>09.1_Soft_LED</strong></p>
<img alt="2.Python_Tutorial/img/4.software/9.1.png" src="2.Python_Tutorial/img/4.software/9.1.png" />
<p>Click “Run current script”. Rotate the handle of potentiometer and the brightness
of LED will change correspondingly.</p>
<p>The following is the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">Pin</span><span class="p">,</span><span class="n">PWM</span><span class="p">,</span><span class="n">ADC</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">pwm</span> <span class="o">=</span><span class="n">PWM</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">adc</span><span class="o">=</span><span class="n">ADC</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">adc</span><span class="o">.</span><span class="n">atten</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">ATTN_11DB</span><span class="p">)</span>
<span class="n">adc</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">WIDTH_12BIT</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">remap</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">oldMin</span><span class="p">,</span><span class="n">oldMax</span><span class="p">,</span><span class="n">newMin</span><span class="p">,</span><span class="n">newMax</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">newMax</span><span class="o">-</span><span class="n">newMin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">oldMax</span><span class="o">-</span><span class="n">oldMin</span><span class="p">))</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">adcValue</span><span class="o">=</span><span class="n">adc</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">pwmValue</span><span class="o">=</span><span class="n">remap</span><span class="p">(</span><span class="n">adcValue</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4095</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1023</span><span class="p">)</span>
        <span class="n">pwm</span><span class="o">.</span><span class="n">duty</span><span class="p">(</span><span class="n">pwmValue</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">adcValue</span><span class="p">,</span><span class="n">pwmValue</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">pwm</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
</pre></div>
</div>
<p>In the code, read the ADC value of the potentiometer. The ADC value range is
0-4095. However, the default input range of the duty() function is 0-1023.
Therefore, we need to write a remap() function to map the read ADC value to a
value that conforms to the input range of the duty() function.</p>
</section>
</section>
<section id="project-9-2-soft-colorful-light">
<h2>Project 9.2 Soft Colorful Light<a class="headerlink" href="#project-9-2-soft-colorful-light" title="Link to this heading"></a></h2>
<p>In this project, 3 potentiometers are used to control the RGB LED and in principle
it is the same as the Soft Light project. Namely, read the voltage value of the
potentiometer and then convert it to PWM used to control LED brightness. Difference
is that the original project only controlled one LED, but this project required (3)
RGB LEDs.</p>
<section id="id1">
<h3>Component List<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raspberry Pi Pico W x1</p></li>
<li><p>830 Tie-Points Breadboard x1</p></li>
<li><p>Resistor 220Ω  x3</p></li>
<li><p>Potentiometer(10k) x3</p></li>
<li><p>LED-RGB x1</p></li>
<li><p>Jumper Wire Several</p></li>
</ul>
</section>
<section id="id2">
<h3>Connect<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<img alt="2.Python_Tutorial/img/3.connect/9.2.png" src="2.Python_Tutorial/img/3.connect/9.2.png" />
</section>
<section id="id3">
<h3>Code<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>Open “Thonny”, click “This computer” &gt;&gt; “D:” &gt;&gt; “Micropython_Codes” &gt;&gt; “09.2_Soft_C
olorful_Light” and double click “Soft_Colorful_Light.py”.</p>
<p><strong>09.2_Soft_Colorful_Light</strong></p>
<img alt="2.Python_Tutorial/img/4.software/9.2.png" src="2.Python_Tutorial/img/4.software/9.2.png" />
<p>Click “Run current script” and control the change of RGBLED color by rotating
the handles of three rotary potentiometers.</p>
<p>The following is the program code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">Pin</span><span class="p">,</span><span class="n">PWM</span><span class="p">,</span><span class="n">ADC</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">pwm0</span><span class="o">=</span><span class="n">PWM</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">pwm1</span><span class="o">=</span><span class="n">PWM</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">39</span><span class="p">,</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">pwm2</span><span class="o">=</span><span class="n">PWM</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">adc0</span><span class="o">=</span><span class="n">ADC</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">adc1</span><span class="o">=</span><span class="n">ADC</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="n">adc2</span><span class="o">=</span><span class="n">ADC</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<span class="n">adc0</span><span class="o">.</span><span class="n">atten</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">ATTN_11DB</span><span class="p">)</span>
<span class="n">adc1</span><span class="o">.</span><span class="n">atten</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">ATTN_11DB</span><span class="p">)</span>
<span class="n">adc2</span><span class="o">.</span><span class="n">atten</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">ATTN_11DB</span><span class="p">)</span>
<span class="n">adc0</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">WIDTH_12BIT</span><span class="p">)</span>
<span class="n">adc1</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">WIDTH_12BIT</span><span class="p">)</span>
<span class="n">adc2</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">ADC</span><span class="o">.</span><span class="n">WIDTH_12BIT</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">remap</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">oldMin</span><span class="p">,</span><span class="n">oldMax</span><span class="p">,</span><span class="n">newMin</span><span class="p">,</span><span class="n">newMax</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">newMax</span><span class="o">-</span><span class="n">newMin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">oldMax</span><span class="o">-</span><span class="n">oldMin</span><span class="p">))</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">pwm0</span><span class="o">.</span><span class="n">duty</span><span class="p">(</span><span class="mi">1023</span><span class="o">-</span><span class="n">remap</span><span class="p">(</span><span class="n">adc0</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">4095</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1023</span><span class="p">))</span>
        <span class="n">pwm1</span><span class="o">.</span><span class="n">duty</span><span class="p">(</span><span class="mi">1023</span><span class="o">-</span><span class="n">remap</span><span class="p">(</span><span class="n">adc1</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">4095</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1023</span><span class="p">))</span>
        <span class="n">pwm2</span><span class="o">.</span><span class="n">duty</span><span class="p">(</span><span class="mi">1023</span><span class="o">-</span><span class="n">remap</span><span class="p">(</span><span class="n">adc2</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">4095</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1023</span><span class="p">))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">pwm0</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
    <span class="n">pwm1</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
    <span class="n">pwm2</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
</pre></div>
</div>
<p>In the code, read the ADC value of 3 potentiometers and map it into PWM duty cyc
le to control the control 3 LEDs with different color of RGBLED, respectively.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, LAFVIN.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>