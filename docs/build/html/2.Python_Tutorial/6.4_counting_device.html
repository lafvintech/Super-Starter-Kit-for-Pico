<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6.4 Counting Device &mdash; Super-Starter-Kit-for-ESP32-S3-WROOM  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.5 Motion Capture Controller" href="6.5_motion_capture_controller.html" />
    <link rel="prev" title="6.3 Alarm Siren Lamp" href="6.3_alarm_siren_lamp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_this_kit.html">About This Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_list.html">Component List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preparation/preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1.C_Tutorial/c_tutorial.html">C Language Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="python_tutorial.html">Python Language Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0_python_preparation.html">Python Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_output%26input.html">1 Output &amp; Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_sound%26display%26movement.html">2 Sound &amp; Display &amp; Movement</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_controller.html">3 Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_microchip.html">4 Microchip</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_advanced.html">5 Advanced</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="6_fun_projects.html">6 Fun Projects</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="6.1_light_theremin.html">6.1 Light Theremin</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.2_electronic_thermometer.html">6.2 Electronic thermometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.3_alarm_siren_lamp.html">6.3 Alarm Siren Lamp</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6.4 Counting Device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#component-list">Component List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#component-knowledge">Component knowledge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#schematic">Schematic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect">Connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#phenomenon">Phenomenon</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="6.5_motion_capture_controller.html">6.5 Motion Capture Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.6_traffic_light.html">6.6 Traffic Light</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.7_digital_level.html">6.7 Digital Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.8_morse_code_generator.html">6.8 Morse Code Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.9_fruit_piano.html">6.9 Fruit Piano</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.10_reversing_alarm.html">6.10 Reversing Alarm</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.11_game_guess_number.html">6.11 Game - Guess Number</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.12_game_10_second.html">6.12 GAME - 10 Second</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.13_rfid_player.html">6.13 RFID Player</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="7_iot_projects.html">7 IoT Projects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../components_Kit/Components_Kit.html">Components Introduction</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Super-Starter-Kit-for-ESP32-S3-WROOM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="python_tutorial.html">Python Language Tutorial</a></li>
          <li class="breadcrumb-item"><a href="6_fun_projects.html">6 Fun Projects</a></li>
      <li class="breadcrumb-item active">6.4 Counting Device</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/2.Python_Tutorial/6.4_counting_device.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="counting-device">
<h1>6.4 Counting Device<a class="headerlink" href="#counting-device" title="Link to this heading"></a></h1>
<p>Here we will make a number-displaying counter system, consisting of a PIR sensor and a 4-digit segment display. When the PIR detects that someone is passing by, the number on the 4-digit segment display will add 1. You can use this counter to count the number of people walking through the passageway.</p>
<section id="component-list">
<h2>Component List<a class="headerlink" href="#component-list" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Raspberry Pi Pico W x1</p></li>
<li><p>MicroUSB cable x1</p></li>
<li><p>830 Tie-Points Breadboard x1</p></li>
<li><p>Resistor 220Ω x4</p></li>
<li><p>4-Digit 7-Segment Display x1</p></li>
<li><p>74HC595 x1</p></li>
<li><p>PIR Motion Sensor Module x1</p></li>
<li><p>Jumper Wire Several</p></li>
</ul>
</section>
<section id="component-knowledge">
<h2>Component knowledge<a class="headerlink" href="#component-knowledge" title="Link to this heading"></a></h2>
<section id="transistor">
<h3><a class="reference internal" href="../components_Kit/component_transistor.html#cpn-transistor"><span class="std std-ref">transistor</span></a><a class="headerlink" href="#transistor" title="Link to this heading"></a></h3>
</section>
<section id="buzzer">
<h3><a class="reference internal" href="../components_Kit/component_buzzer.html#cpn-buzzer"><span class="std std-ref">Buzzer</span></a><a class="headerlink" href="#buzzer" title="Link to this heading"></a></h3>
</section>
</section>
<section id="schematic">
<h2>Schematic<a class="headerlink" href="#schematic" title="Link to this heading"></a></h2>
<img alt="2.Python_Tutorial/img/2.sch/6.4.png" src="2.Python_Tutorial/img/2.sch/6.4.png" />
<p>This circuit is based on the 4.3 4 Digit 7 Segment Timer with the addition of a PIR module.</p>
<p>The PIR will send a high signal of about 2.8s long when someone passes by.</p>
<p>The PIR module has two potentiometers: one adjusts sensitivity, the other adjusts detection distance. To make the PIR module work better, you need to turn both of them counterclockwise to the end.</p>
<img alt="2.Python_Tutorial/img/6.other/PIR.png" src="2.Python_Tutorial/img/6.other/PIR.png" />
</section>
<section id="connect">
<h2>Connect<a class="headerlink" href="#connect" title="Link to this heading"></a></h2>
<img alt="2.Python_Tutorial/img/3.connect/6.4.png" src="2.Python_Tutorial/img/3.connect/6.4.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The PIR sensor will have a one-minute initialization time after powering on. During this period, infrared signals should be avoided, otherwise the measurement may be inaccurate.</p></li>
<li><p>There are two potentiometers on the PIR module: one is to adjust sensitivity and the other is to adjust the detection distance. To make the PIR module work better, you You need to turn both of them counterclockwise to the end.</p></li>
</ul>
</div>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">6.4_counting_device.py</span></code> file under the path of <code class="docutils literal notranslate"><span class="pre">Super-Starter-Kit-for-Pico\Python\1.Project</span></code> or copy this code into Thonny, then click “Run Current Script” or simply press F5 to run it.</p></li>
<li><p>Don’t forget to click on the “MicroPython (Raspberry Pi Pico)” interpreter in the bottom right corner.</p></li>
</ul>
</div>
<img alt="../_images/6.4.png" src="../_images/6.4.png" />
<p>Click “Run current script”, the number on the 4-digit 7-segment display will be added by one if someone passes in front of the PIR module.</p>
<p>The following is the program code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lcd1602</span> <span class="kn">import</span> <span class="n">LCD</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">I2C</span><span class="p">,</span> <span class="n">Pin</span>
<span class="kn">import</span> <span class="nn">utime</span> <span class="k">as</span> <span class="nn">time</span>

<span class="n">pir</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
<span class="n">i2c</span> <span class="o">=</span> <span class="n">I2C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sda</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">scl</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="mi">400000</span><span class="p">)</span>
<span class="n">lcd</span> <span class="o">=</span> <span class="n">LCD</span><span class="p">(</span><span class="n">i2c</span><span class="p">)</span>

<span class="n">motion_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">last_detection_time</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">display_status</span><span class="p">(</span><span class="n">motion_detected</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
    <span class="n">lcd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">motion_detected</span><span class="p">:</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;Motion Detected!</span><span class="se">\n</span><span class="s2">Count: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;Monitoring...</span><span class="se">\n</span><span class="s2">Count: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>

<span class="c1"># Main loop</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PIR Sensor initializing...&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Wait for the PIR sensor to stabilize</span>
<span class="n">lcd</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;System Ready</span><span class="se">\n</span><span class="s2">Starting...&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pir</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Motion detected</span>
            <span class="c1"># Check if this is a new motion (at least 2 seconds since the last detection)</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_diff</span><span class="p">(</span><span class="n">current_time</span><span class="p">,</span> <span class="n">last_detection_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
                <span class="n">motion_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">last_detection_time</span> <span class="o">=</span> <span class="n">current_time</span>
                <span class="n">display_status</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">motion_count</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Motion detected! Count:&quot;</span><span class="p">,</span> <span class="n">motion_count</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No motion detected</span>
            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">ticks_diff</span><span class="p">(</span><span class="n">current_time</span><span class="p">,</span> <span class="n">last_detection_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
                <span class="n">display_status</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">motion_count</span><span class="p">)</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Short delay to avoid excessive detection frequency</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">lcd</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s2">&quot;Error occurred</span><span class="se">\n</span><span class="s2">Restarting...&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">continue</span>
</pre></div>
</div>
</section>
<section id="phenomenon">
<h2>Phenomenon<a class="headerlink" href="#phenomenon" title="Link to this heading"></a></h2>
<div  class="align-left"><video controls="True" preload="auto" width="100%"><source src="../_images/6.4.mp4" type="video/mp4"></video></div></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="6.3_alarm_siren_lamp.html" class="btn btn-neutral float-left" title="6.3 Alarm Siren Lamp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="6.5_motion_capture_controller.html" class="btn btn-neutral float-right" title="6.5 Motion Capture Controller" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Lafvin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>