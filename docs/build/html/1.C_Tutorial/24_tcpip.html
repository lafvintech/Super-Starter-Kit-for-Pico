<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter 24 TCP/IP &mdash; Super-Starter-Kit-for-ESP32-S3-WROOM  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 25 Camera Web Server" href="25_camera_web_server.html" />
    <link rel="prev" title="Chapter 23 WiFi Working Modes" href="23_wifi_working_modes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_this_kit.html">About This Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../component_list.html">Component List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preparation/preparation.html">Preparation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="c_tutorial.html">C Language Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="C_preparation.html">C Language Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="0_led.html">Chapter 0 LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_led.html">Chapter 1 LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_btn%26led.html">Chapter 2 Button &amp; LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_led_bar.html">Chapter 3 LED Bar</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_analog%26pwm.html">Chapter 4 Analog &amp; PWM</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_rgb_led.html">Chapter 5 RGB LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_buzzer.html">Chapter 6 Buzzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_serial_communication.html">Chapter 7 Serial Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_ad_converter.html">Chapter 8 AD Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_touch_sensor.html">Chapter 9 Touch Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_potentiometer.html">Chapter 10 Potentiometer &amp; LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_photoresistor.html">Chapter 11 Photoresistor &amp; LED</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_thermistor.html">Chapter 12 Thermistor</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_joystick.html">Chapter 13 Joystick</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_74HC595%26led_bar_graph.html">Chapter 14 74HC595 &amp; LED Bar Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_74HC595%267-segment_display.html">Chapter 15 74HC595 &amp; 7-Segment Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_relay%26motor.html">Chapter 16 Relay &amp; Motor</a></li>
<li class="toctree-l2"><a class="reference internal" href="17_servo.html">Chapter 17 Servo</a></li>
<li class="toctree-l2"><a class="reference internal" href="18_lcd1602.html">Chapter 18 LCD1602</a></li>
<li class="toctree-l2"><a class="reference internal" href="19_ultrasonic_ranging.html">Chapter 19 Ultrasonic Ranging</a></li>
<li class="toctree-l2"><a class="reference internal" href="20_bluetooth.html">Chapter 20 Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="21_read_and_write_the_sdcard.html">Chapter 21 Read and Write the SDcard</a></li>
<li class="toctree-l2"><a class="reference internal" href="22_play_sd_card_music.html">Chapter 22 Play SD card music</a></li>
<li class="toctree-l2"><a class="reference internal" href="23_wifi_working_modes.html">Chapter 23 WiFi Working Modes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Chapter 24 TCP/IP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#project-24-1-as-client">Project 24.1 As Client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connect">Connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sketch">Sketch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#project-24-2-as-server">Project 24.2 As Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Sketch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="25_camera_web_server.html">Chapter 25 Camera Web Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="26_camera_tcp_server.html">Chapter 26 Camera Tcp Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2.Python_Tutorial/python_tutorial.html">Python Language Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components_Kit/Components_Kit.html">Components Introduction</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Super-Starter-Kit-for-ESP32-S3-WROOM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="c_tutorial.html">C Language Tutorial</a></li>
      <li class="breadcrumb-item active">Chapter 24 TCP/IP</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/1.C_Tutorial/24_tcpip.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chapter-24-tcp-ip">
<h1>Chapter 24 TCP/IP<a class="headerlink" href="#chapter-24-tcp-ip" title="Link to this heading"></a></h1>
<p>In this chapter, we will introduce how ESP32-S3 implements network communications
based on TCP/IP protocol. There are two roles in TCP/IP communication, namely
Server and Client, which will be implemented respectively with two projects in
this chapter.</p>
<section id="project-24-1-as-client">
<h2>Project 24.1 As Client<a class="headerlink" href="#project-24-1-as-client" title="Link to this heading"></a></h2>
<p>In this section, ESP32-S3 is used as Client to connect Server on the same LAN
and communicate with it.</p>
<p><strong>Install Processing</strong>
In this tutorial, we use Processing to build a simple TCP/IP communication
platform. If you’ve not installed Processing, you can download it by clicking
<a class="reference external" href="https://processing.org/download/">https://processing.org/download/</a>. You can choose an appropriate version to downl
oad according to your PC system.</p>
<img alt="../_images/processing1.png" src="../_images/processing1.png" />
<p>Unzip the downloaded file to your computer. Click “processing.exe” as the figure
below to run this software.</p>
<img alt="../_images/processing2.png" src="../_images/processing2.png" />
<p><strong>Use Server mode for communication</strong></p>
<p>Install ControlP5.</p>
<img alt="../_images/processing3.png" src="../_images/processing3.png" />
<img alt="../_images/processing0.png" src="../_images/processing0.png" />
<p>Open the “Super_Starter_Kit_for_ESP32_S3\Sketches\Sketches\Sketch_24.1_
WiFiClient\sketchWiFi\Processing_wifi.pde”, and click “Run”.</p>
<img alt="../_images/processing4.png" src="../_images/processing4.png" />
<p>The new pop-up interface is as follows. If ESP32-S3 is used as client, select
TCP SERVER mode for sketchWiFi.</p>
<img alt="../_images/processing5.png" src="../_images/processing5.png" />
<p>When sketchWiFi selects TCP SERVER mode, ESP32-S3 Sketch needs to be changed
according to sketchWiFi’s displaying of LOCAL IP or LOCAL PORT.</p>
<p>When sketchWiFi selects TCP CLIENT mode, the LOCAL IP and LOCAL PORT of sketchWi
Fi need to be changed according to the IP address and port number printed by the
serial monitor.</p>
<p><strong>Mode selection</strong>: select Server mode/Client mode.</p>
<p><strong>IP address</strong>: In server mode, this option does not need to be filled in, and the computer will automatically obtain
the IP address. In client mode, fill in the remote IP address to be connected.</p>
<p><strong>Port number</strong>: In server mode, fill in a port number for client devices to make an
access connection. In client mode, fill in port number given by the Server devices
to make an access connection.</p>
<p><strong>Start button</strong>: In server mode, push the button, then the computer will serve as
server and open a port number for client to make access connection. During this
period, the computer will keep monitoring. In client mode, before pushing the
button, please make sure the server is on, remote IP address and remote port number
is correct; push the button, and the computer will make access connection to the
remote port number of the remote IP as a client.</p>
<p><strong>clear receive</strong>: clear out the content in the receiving text box
<strong>clear send</strong>: clear out the content in the sending text box
<strong>Sending button</strong>: push the sending button, the computer will send the content in
the text box to others.</p>
<section id="connect">
<h3>Connect<a class="headerlink" href="#connect" title="Link to this heading"></a></h3>
<img alt="../_images/connect1.png" src="../_images/connect1.png" />
</section>
<section id="sketch">
<h3>Sketch<a class="headerlink" href="#sketch" title="Link to this heading"></a></h3>
<p>Before running the Sketch, please open “Processing_wifi.pde.” first, and click “Run”.</p>
<img alt="1.C_Tutorial/img/4.software/24.3.png" src="1.C_Tutorial/img/4.software/24.3.png" />
<p>The newly pop up window will use the computer’s IP address by default and open a
data monitor port.</p>
<img alt="../_images/processing4-1.png" src="../_images/processing4-1.png" />
<p>Next, open Sketch_24.1_WiFiClient.ino. Before running it, please change the foll
owing information based on “LOCAL IP” and “LOCAL PORT” in the figure above.</p>
<img alt="1.C_Tutorial/img/4.software/24.1.png" src="1.C_Tutorial/img/4.software/24.1.png" />
<p>REMOTE_IP needs to be filled in according to the interface of Processing_wifi.pde.
Taking this tutorial as an example, its REMOTE_IP is “192.168.2.112”. Generally,
by default, the ports do not need to change its value.</p>
<p>Click LISTENING, turn on TCP SERVER’s data listening function and wait for
ESP32-S3 to connect.</p>
<img alt="../_images/processing4-2.png" src="../_images/processing4-2.png" />
<p>Compile and upload code to ESP32-S3 WROOM, open the serial monitor and set the
baud rate to 115200. ESP32-S3 connects router, obtains IP address and sends access
request to server IP address on the same LAN till the connection is successful.
When connect successfully, ESP32-S3 can send messages to server.</p>
<img alt="../_images/24.1.png" src="../_images/24.1.png" />
<p>ESP32-S3 connects with TCP SERVER, and TCP SERVER receives messages from ESP32-S3,
as shown in the figure below.</p>
<img alt="../_images/processing5.png" src="../_images/processing5.png" />
<p><strong>Sketch_24.1_As_Client</strong>
Code
^^^^^^
The following is the program code:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;WiFi.h&gt;</span>

<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">ssid_Router</span><span class="w">     </span><span class="o">=</span><span class="w">  </span><span class="s">&quot;xxxxxxxxxxx&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">//Enter the router name</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">password_Router</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="s">&quot;xxxxxxxxxxx&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">//Enter the router password</span>
<span class="cp">#define     REMOTE_IP          &quot;xxxxxxxxxxx&quot;  </span><span class="c1">//input the remote server which is you want to connect</span>
<span class="cp">#define     REMOTE_PORT         8888       </span><span class="c1">//input the remote port which is the remote provide</span>
<span class="n">WiFiClient</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid_Router</span><span class="p">,</span><span class="w"> </span><span class="n">password_Router</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Waiting for WiFi... &quot;</span><span class="p">);</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">WL_CONNECTED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;WiFi connected&quot;</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;IP address: &quot;</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">localIP</span><span class="p">());</span>
<span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>

<span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Connecting to &quot;</span><span class="p">);</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">REMOTE_IP</span><span class="p">);</span>

<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">client</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">REMOTE_IP</span><span class="p">,</span><span class="w"> </span><span class="n">REMOTE_PORT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Connection failed.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Waiting a moment before retrying...&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Connected&quot;</span><span class="p">);</span>
<span class="n">client</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">client</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;This is my IP.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">available</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//read back one line from the server</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">readString</span><span class="p">();</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">REMOTE_IP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">line</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Serial</span><span class="p">.</span><span class="n">readString</span><span class="p">();</span>
<span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">connected</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>
<span class="w">    </span><span class="n">WiFi</span><span class="p">.</span><span class="n">disconnect</span><span class="p">();</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="project-24-2-as-server">
<h2>Project 24.2 As Server<a class="headerlink" href="#project-24-2-as-server" title="Link to this heading"></a></h2>
<p>In this section, ESP32-S3 is used as a server to wait for the connection and com
munication of client on the same LAN.</p>
<section id="id1">
<h3>Connect<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Connect ESP32-S3 to the computer using a USB cable.</p>
<img alt="../_images/connect1.png" src="../_images/connect1.png" />
</section>
<section id="id2">
<h3>Sketch<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>Before running Sketch, please modify the contents of the box below first.</p>
<p><strong>Sketch_24.2_As_Server</strong></p>
<img alt="1.C_Tutorial/img/4.software/24.2.png" src="1.C_Tutorial/img/4.software/24.2.png" />
<p>Compile and upload code to ESP32-S3 WROOM board, open the serial monitor and set
the baud rate to 115200. Turn on server mode for ESP32-S3, waiting for the connec
tion of other devices on the same LAN. Once a device connects to server success
fully, they can send messages to each other. If the ESP32-S3 fails to connect to
router, press the reset button as shown below and wait for ESP32-S3 to run again.</p>
<img alt="../_images/24.2.png" src="../_images/24.2.png" />
<p>Processing： Open the “Super_Starter_Kit_for_ESP32_S3\Sketches\Sketches
\Sketch_24.2_WiFiServer\sketchWiFi\Processing_wifi.pde”. Based on the messages printed
by the serial monitor, enter correct IP address and serial port in Processing to
establish connection and make communication.</p>
<img alt="../_images/processing24.2.png" src="../_images/processing24.2.png" />
</section>
<section id="code">
<h3>Code<a class="headerlink" href="#code" title="Link to this heading"></a></h3>
<p>The following is the program code:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;WiFi.h&gt;</span>

<span class="cp">#define port 80</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">ssid_Router</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;********&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">//input your wifi name</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">password_Router</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;********&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">//input your wifi passwords</span>
<span class="n">WiFiServer</span><span class="w">  </span><span class="nf">server</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Connecting to &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">ssid_Router</span><span class="p">);</span>
<span class="w">    </span><span class="n">WiFi</span><span class="p">.</span><span class="n">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid_Router</span><span class="p">,</span><span class="w"> </span><span class="n">password_Router</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">WL_CONNECTED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;WiFi connected.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;IP address: &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">localIP</span><span class="p">());</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;IP port: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">port</span><span class="p">);</span>
<span class="w">    </span><span class="n">server</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">port</span><span class="p">);</span>
<span class="w">    </span><span class="n">WiFi</span><span class="p">.</span><span class="n">setAutoReconnect</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">(){</span>
<span class="n">WiFiClient</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span><span class="p">.</span><span class="n">accept</span><span class="p">();</span><span class="w">               </span><span class="c1">// listen for incoming clients</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                                     </span><span class="c1">// if you get a client,</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Client connected.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">connected</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">                    </span><span class="c1">// loop while the client&#39;s connected</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">available</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="c1">// if there&#39;s bytes to read from the client,</span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">readStringUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">));</span><span class="w"> </span><span class="c1">// print it out the serial monitor</span>
<span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">read</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">);</span><span class="w">                     </span><span class="c1">// clear the wifi receive area cache</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()){</span><span class="w">                       </span><span class="c1">// if there&#39;s bytes to read from the serial monitor,</span>
<span class="w">        </span><span class="n">client</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">readStringUntil</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">));</span><span class="w"> </span><span class="c1">// print it out the client.</span>
<span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">);</span><span class="w">                     </span><span class="c1">// clear the wifi receive area cache</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w">                                  </span><span class="c1">// stop the client connecting.</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Client Disconnected.&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="23_wifi_working_modes.html" class="btn btn-neutral float-left" title="Chapter 23 WiFi Working Modes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="25_camera_web_server.html" class="btn btn-neutral float-right" title="Chapter 25 Camera Web Server" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, LAFVIN.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>